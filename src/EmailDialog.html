<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
  </head>
  <body>
    <form id="emailForm">
      <label for="emailAddress">Email Address:</label>
      <input type="email" id="emailAddress" name="emailAddress" required oninput="validateEmail()">
      <div id="checkboxContainer">
        <? for (var i = 0; i < actionSpecTypes.length; i++) { ?>
          <input type="checkbox" name="selectedKeys" value="<?= actionSpecTypes[i] ?>" id="<?= actionSpecTypes[i] ?>">
          <label for="<?= actionSpecTypes[i] ?>"><?= actionSpecTypes[i] ?></label><br>
        <? } ?>
      </div>
      <button type="button" onclick="submitForm()" disabled>Send</button>
    </form>
    <script>
      function validateEmail() {
        var emailInput = document.getElementById('emailAddress');
        var submitButton = document.querySelector('button[onclick="submitForm()"]');
        submitButton.disabled = !emailInput.checkValidity();
      }

      function submitForm() {
        var form = document.getElementById('emailForm');
        google.script.run.withSuccessHandler(google.script.host.close).sendEmail(form);
      }
    </script>
  </body>
</html>
